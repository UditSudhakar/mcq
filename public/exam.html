<!DOCTYPE html>
<html>
<head>
  <title>Exam</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Exam Started</h2>
<form id="examForm"></form>
<button onclick="submitExam()">Submit</button>

<script>

fetch("/questions")
.then(res => res.json())
.then(data => {

  let form = document.getElementById("examForm");

  data.forEach(q => {
    form.innerHTML += `
      <p>${q.question}</p>
      ${q.options.map(opt =>
        `<input type="radio" name="q${q.id}" value="${opt}">${opt}<br>`
      ).join("")}
      <hr>
    `;
  });

});

function submitExam(){
  let form = document.getElementById("examForm");
  let formData = new FormData(form);

  fetch("/submit", {
    method: "POST",
    body: new URLSearchParams(formData)
  })
  .then(res => res.json())
  .then(data => {
    localStorage.setItem("score", data.score);
    localStorage.setItem("total", data.total);
    window.location="loading.html";
  });
}

</script>

</body>
</html>
